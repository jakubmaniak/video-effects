(this["webpackJsonpvideo-effects"]=this["webpackJsonpvideo-effects"]||[]).push([[0],[,,,,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){},,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),s=n(9),o=n.n(s),i=(n(16),n(3)),r=(n(17),n(28)),l=Promise.all([n.e(3).then(n.bind(null,29)),n.e(6).then(n.bind(null,30)),n.e(10).then(n.bind(null,31)),n.e(5).then(n.bind(null,32)),n.e(7).then(n.bind(null,33)),n.e(8).then(n.bind(null,34)),n.e(4).then(n.bind(null,35)),n.e(9).then(n.bind(null,36))]),u=n(7),d=(n(18),n(19),n(2));var j=function(e){return Object(d.jsx)("button",{className:"preset"+(e.selected?" preset--selected":""),onClick:e.onClick,children:e.name})};var b=function(e){var t=Object(c.useRef)();return Object(c.useEffect)((function(){t.current.scrollTop=t.current.scrollHeight}),[e.presets]),Object(d.jsx)("div",{className:"preset__list",ref:t,children:Object(u.a)(e.presets).map((function(t){return Object(d.jsx)(j,{name:t.name,selected:t===e.selectedPreset,onClick:function(){return function(t){var n;t!==e.selectedPreset&&(null===(n=e.onSelectPreset)||void 0===n||n.call(e,t))}(t)}},t.id)}))})},v=(n(21),n(10));var p=function(e){var t=Object(c.useState)(),n=Object(i.a)(t,2),a=n[0],s=n[1],o=Object(c.useState)(""),r=Object(i.a)(o,2),l=r[0],u=r[1];return Object(c.useEffect)((function(){var t;u(null===(t=e.preset)||void 0===t?void 0:t.code)}),[e.preset]),Object(d.jsx)(v.a,{height:"360px",language:"javascript",onMount:function(e,t){var n=["declare const width: number;","declare const height: number;","declare type Color = { r: number, g: number, b: number, a: number };","declare function get(x: number, y: number, copy: number = null): Color;","declare function set(x: number, y: number, color: Partial<Color> = {}, copy: number = null): void;","declare function copyFrame(): number;","declare function apply(copy: number = null): void;"].join("\n\n");t.languages.typescript.javascriptDefaults.setCompilerOptions({target:t.languages.typescript.ScriptTarget.ES2019,lib:["es2019"],allowNonTsExtensions:!0}),t.languages.typescript.javascriptDefaults.addExtraLib(n,"ts:filename/sandbox.d.ts"),t.editor.createModel(n,"typescript",t.Uri.parse("ts:filename/sandbox.d.ts"))},loading:"Loading preset editor...",options:{minimap:{enabled:!1}},value:l,onChange:function(t){var n;a!==e.preset?s(e.preset):null===(n=e.onCodeChange)||void 0===n||n.call(e,t)}})};var m=function(e){var t=Object(c.useState)(new Set),n=Object(i.a)(t,2),a=n[0],s=n[1],o=Object(c.useState)(),u=Object(i.a)(o,2),j=u[0],v=u[1],m=Object(c.useState)(""),f=Object(i.a)(m,2),O=f[0],h=f[1],g=Object(c.useState)(!1),x=Object(i.a)(g,2),S=x[0],w=x[1];function y(e){v(e),h(e.code),C(e.code),w(!1)}function C(t){var n;null===(n=e.onManipulatorChange)||void 0===n||n.call(e,(function(){return new Function("width","height","fps","get","set","copyFrame","apply",t)}))}return Object(c.useEffect)((function(){l.then((function(e){a=new Set(e.map((function(e){return{id:Object(r.a)(),name:e.name,code:e.code.trim()}}))),s(a),y(a.values().next().value)}))}),[]),Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("section",{className:"app-section",children:[Object(d.jsxs)("header",{children:[Object(d.jsx)("h1",{className:"app-section__title",children:"Presets"}),Object(d.jsx)("button",{onClick:function(){var e={id:Object(r.a)(),name:"My preset",code:"\nfor (let y = 0; y < height; y++) {\n    for (let x = 0; x < width; x++) {\n        let {r, g, b} = get(x, y);\n        \n        set(x, y, {r, g, b});\n    }\n}\n".trim()};a.add(e),s(new Set(a)),y(e)},children:"Add new preset"})]}),Object(d.jsx)("div",{className:"presets",children:Object(d.jsx)(b,{presets:a,selectedPreset:j,onSelectPreset:y})})]}),Object(d.jsxs)("section",{className:"app-section",children:[Object(d.jsxs)("header",{children:[Object(d.jsx)("h1",{className:"app-section__title",children:"Preset editor"}),Object(d.jsx)("button",{onClick:function(){j.code=O,s(new Set(a)),C(O),w(!1)},disabled:!S,children:"Save changes"})]}),Object(d.jsx)("div",{className:"preset-editor",children:Object(d.jsx)(p,{preset:j,onCodeChange:function(e){h(e),w(!0)}})})]})]})},f=n(4);n(24),n(25);var O=function(e){var t,n,a,s,o=Object(c.useState)(!1),r=Object(i.a)(o,2),l=r[0],u=r[1];return Object(c.useEffect)((function(){!e.selected===l&&u(!!e.selected)}),[e.selected]),Object(d.jsxs)("button",{className:"video-source"+(l?" video-source--selected":""),onClick:e.onClick,children:[Object(d.jsx)("span",{className:"video-source__name",children:null!==(t=e.name)&&void 0!==t?t:"Video source"}),Object(d.jsx)("span",{className:"video-source__address",children:(a=null!==(n=e.source)&&void 0!==n?n:"",s=40,a.length>s?"..."+a.slice(3-s):a)})]})};var h=function(e){return Object(d.jsx)("div",{className:"video-source__list",children:Object(u.a)(e.videoSources).map((function(t){return Object(d.jsx)(O,Object(f.a)({selected:t===e.selectedVideoSource,onClick:function(){var n;return null===(n=e.onSelectVideoSource)||void 0===n?void 0:n.call(e,t)}},t),t.id)}))})};n(26);var g=function(e){var t=Object(c.useRef)(),n=Object(c.useRef)(),a=Object(c.useRef)(),s=Object(c.useState)(!0),o=Object(i.a)(s,2),r=o[0],l=o[1],u=Object(c.useState)(!0),j=Object(i.a)(u,2),b=j[0],v=j[1];return Object(c.useEffect)((function(){var e=document.createElement("video");e.crossOrigin="anonymous",e.muted=!0,e.loop=!0,n.current=e;var c=t.current.getContext("2d"),s=document.createElement("canvas");s.width=640,s.height=360;var o=s.getContext("2d");setInterval((function(){var t;o.drawImage(e,0,0,640,360);var n=o.getImageData(0,0,640,360),s=[],i=n;null===(t=a.current)||void 0===t||t.call(a,n.width,n.height,(function(){}),(function(e,t){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=null!==c?s[c]:n,o=4*(a.width*t+e);return{r:a.data[o],g:a.data[o+1],b:a.data[o+2],a:a.data[o+3]}}),(function(e,t,c){var a=c.r,o=void 0===a?null:a,i=c.g,r=void 0===i?null:i,l=c.b,u=void 0===l?null:l,d=c.a,j=void 0===d?null:d,b=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,v=null!==b?s[b]:n,p=4*(v.width*t+e);null!=o&&(v.data[p]=o),null!=r&&(v.data[p+1]=r),null!=u&&(v.data[p+2]=u),null!=j&&(v.data[p+3]=j)}),(function(){var e=c.createImageData(n.width,n.height);return e.data.set(new Uint8ClampedArray(n.data)),s.push(e)-1}),(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;i=null!==e?s[e]:n})),c.putImageData(i,0,0)}),1e3/24)}),[]),Object(c.useEffect)((function(){var t;n.current.src=null===(t=e.videoSource)||void 0===t?void 0:t.source,n.current.play()}),[e.videoSource]),Object(c.useEffect)((function(){a.current=e.manipulator}),[e.manipulator]),Object(d.jsxs)("div",{className:"video-preview__container",children:[Object(d.jsx)("canvas",{className:"video-preview__canvas",width:"640",height:"360",ref:t}),Object(d.jsxs)("div",{className:"video-controls",children:[Object(d.jsx)("button",{className:r?"video-control--pause":"video-control--play",onClick:function(){r?n.current.pause():n.current.play(),l(!r)}}),Object(d.jsx)("button",{className:b?"video-control--volume-mute":"video-control--volume-medium",onClick:function(){n.current.muted=!b,v(!b)}})]})]})};var x=function(e){var t=Object(c.useState)(new Set),n=Object(i.a)(t,2),a=n[0],s=n[1],o=Object(c.useState)(),l=Object(i.a)(o,2),u=l[0],j=l[1],b=Object(c.useState)(),v=Object(i.a)(b,2),p=v[0],m=v[1];return Object(c.useEffect)((function(){a=new Set([{id:Object(r.a)(),name:"Big Buck Bunny",source:"https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4"},{id:Object(r.a)(),name:"Tears of Steel",source:"http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/TearsOfSteel.mp4"},{id:Object(r.a)(),name:"Snow Slowly Falling Down",source:"/videos/SnowSlowlyFallingDown.mp4"}]),s(a),j(a.values().next().value)}),[]),Object(c.useEffect)((function(){m((function(){return e.manipulator}))}),[e.manipulator]),Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("section",{className:"app-section",children:[Object(d.jsx)("header",{children:Object(d.jsx)("h1",{className:"app-section__title",children:"Video sources"})}),Object(d.jsx)("div",{className:"video-sources",children:Object(d.jsx)(h,{videoSources:a,selectedVideoSource:u,onSelectVideoSource:function(e){u!==e&&j(e)}})})]}),Object(d.jsxs)("section",{className:"app-section",children:[Object(d.jsx)("header",{children:Object(d.jsx)("h1",{className:"app-section__title",children:"Video preview"})}),Object(d.jsx)("div",{className:"video-preview",children:Object(d.jsx)(g,{videoSource:u,manipulator:p})})]})]})};var S=function(){var e=Object(c.useState)(),t=Object(i.a)(e,2),n=t[0],a=t[1];return Object(d.jsxs)("div",{className:"app",children:[Object(d.jsx)("div",{className:"app__column",children:Object(d.jsx)(x,{manipulator:n})}),Object(d.jsx)("div",{className:"app__column",children:Object(d.jsx)(m,{onManipulatorChange:a})})]})},w=function(e){e&&e instanceof Function&&n.e(11).then(n.bind(null,37)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,s=t.getLCP,o=t.getTTFB;n(e),c(e),a(e),s(e),o(e)}))};o.a.render(Object(d.jsx)(a.a.StrictMode,{children:Object(d.jsx)(S,{})}),document.getElementById("root")),w()}],[[27,1,2]]]);
//# sourceMappingURL=main.e433b734.chunk.js.map